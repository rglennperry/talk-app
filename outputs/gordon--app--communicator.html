<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<title>Communicator</title>
<style>
  * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

  :root {
    --bg: #1a1a2e;
    --surface: #16213e;
    --card: #0f3460;
    --accent: #e94560;
    --text: #ffffff;
    --text-dim: #a0a0b8;
    --success: #2ecc71;
    --warning: #f39c12;
    --danger: #e74c3c;
    --info: #3498db;
    --radius: 16px;
    --gap: 10px;
  }

  html, body {
    height: 100%; width: 100%;
    overflow: hidden;
    font-family: -apple-system, "Helvetica Neue", sans-serif;
    background: var(--bg);
    color: var(--text);
    touch-action: manipulation;
    -webkit-user-select: none; user-select: none;
  }

  /* â”€â”€ Layout â”€â”€ */
  #app {
    display: flex; flex-direction: column;
    height: 100%; width: 100%;
    padding: env(safe-area-inset-top) env(safe-area-inset-right) env(safe-area-inset-bottom) env(safe-area-inset-left);
  }

  /* â”€â”€ Quick Bar (always visible) â”€â”€ */
  #quickbar {
    display: flex; gap: var(--gap);
    padding: var(--gap);
    flex-shrink: 0;
  }
  #quickbar .tile {
    flex: 1;
    min-height: 70px;
    font-size: 1.1rem;
    border-radius: var(--radius);
  }
  #quickbar .tile .emoji { font-size: 2rem; }

  .qb-yes   { background: var(--success); }
  .qb-no    { background: var(--danger); }
  .qb-help  { background: var(--warning); color: #222; }
  .qb-pain  { background: var(--accent); }
  .qb-thanks { background: var(--info); }

  /* â”€â”€ Category Tabs â”€â”€ */
  #tabs {
    display: flex; gap: 6px;
    padding: 0 var(--gap);
    flex-shrink: 0;
    overflow-x: auto;
    -webkit-overflow-scrolling: touch;
  }
  .tab {
    flex-shrink: 0;
    padding: 10px 18px;
    font-size: 1rem; font-weight: 600;
    background: var(--surface);
    color: var(--text-dim);
    border: 2px solid transparent;
    border-bottom: none;
    border-radius: var(--radius) var(--radius) 0 0;
    cursor: pointer;
    transition: background 0.15s, color 0.15s;
  }
  .tab.active {
    background: var(--card);
    color: var(--text);
    border-color: var(--accent);
  }

  /* â”€â”€ Message Display â”€â”€ */
  #message-bar {
    display: flex; align-items: center; gap: var(--gap);
    padding: 8px var(--gap);
    flex-shrink: 0;
    min-height: 52px;
  }
  #message-display {
    flex: 1;
    background: var(--surface);
    border: 2px solid var(--card);
    border-radius: var(--radius);
    padding: 10px 16px;
    font-size: 1.3rem;
    font-weight: 600;
    min-height: 44px;
    display: flex; align-items: center;
    overflow: hidden;
    white-space: nowrap;
    text-overflow: ellipsis;
  }
  #clear-btn {
    width: 52px; height: 52px;
    border-radius: 50%;
    background: var(--danger);
    border: none;
    color: white;
    font-size: 1.6rem;
    cursor: pointer;
    flex-shrink: 0;
    display: flex; align-items: center; justify-content: center;
  }
  #speak-btn {
    width: 52px; height: 52px;
    border-radius: 50%;
    background: var(--success);
    border: none;
    color: white;
    font-size: 1.6rem;
    cursor: pointer;
    flex-shrink: 0;
    display: flex; align-items: center; justify-content: center;
  }

  /* â”€â”€ Tile Grid â”€â”€ */
  #grid-container {
    flex: 1;
    overflow-y: auto;
    -webkit-overflow-scrolling: touch;
    padding: var(--gap);
  }
  .grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: var(--gap);
  }

  /* â”€â”€ Tile â”€â”€ */
  .tile {
    display: flex; flex-direction: column;
    align-items: center; justify-content: center;
    gap: 4px;
    padding: 12px 8px;
    min-height: 100px;
    background: var(--card);
    border: 3px solid transparent;
    border-radius: var(--radius);
    cursor: pointer;
    transition: transform 0.1s, border-color 0.15s, opacity 0.15s;
    -webkit-tap-highlight-color: transparent;
  }
  .tile:active {
    transform: scale(0.95);
    border-color: var(--accent);
    opacity: 0.85;
  }
  .tile .emoji {
    font-size: 2.8rem;
    line-height: 1.1;
  }
  .tile .label {
    font-size: 1.05rem;
    font-weight: 700;
    text-align: center;
    line-height: 1.2;
    text-transform: uppercase;
    letter-spacing: 0.03em;
  }

  /* color-coded category backgrounds */
  .cat-needs    .tile { background: #1a5276; }
  .cat-pain     .tile { background: #7b241c; }
  .cat-feelings .tile { background: #1e8449; }
  .cat-people   .tile { background: #6c3483; }
  .cat-actions  .tile { background: #b9770e; color: #fff; }
  .cat-comfort  .tile { background: #117a65; }

  /* â”€â”€ Spoken flash â”€â”€ */
  .tile.spoken {
    border-color: var(--success) !important;
    box-shadow: 0 0 12px rgba(46,204,113,0.5);
  }

  /* â”€â”€ Landscape tweaks â”€â”€ */
  @media (orientation: landscape) {
    .grid { grid-template-columns: repeat(4, 1fr); }
    .tile { min-height: 90px; }
    .tile .emoji { font-size: 2.4rem; }
    #quickbar .tile { min-height: 60px; }
  }

  /* â”€â”€ Larger iPads â”€â”€ */
  @media (min-width: 1024px) {
    .grid { grid-template-columns: repeat(4, 1fr); gap: 14px; }
    .tile { min-height: 120px; padding: 16px 12px; }
    .tile .emoji { font-size: 3.2rem; }
    .tile .label { font-size: 1.2rem; }
  }
</style>
</head>
<body>
<div id="app">

  <!-- Quick Access Bar -->
  <div id="quickbar">
    <div class="tile qb-yes" onclick="speak('Yes')" role="button" aria-label="Yes">
      <span class="emoji">ğŸ‘</span><span class="label">Yes</span>
    </div>
    <div class="tile qb-no" onclick="speak('No')" role="button" aria-label="No">
      <span class="emoji">ğŸ‘</span><span class="label">No</span>
    </div>
    <div class="tile qb-help" onclick="speak('I need help')" role="button" aria-label="Help">
      <span class="emoji">ğŸ†˜</span><span class="label">Help</span>
    </div>
    <div class="tile qb-pain" onclick="speak('I am in pain')" role="button" aria-label="Pain">
      <span class="emoji">ğŸ˜£</span><span class="label">Pain</span>
    </div>
    <div class="tile qb-thanks" onclick="speak('Thank you')" role="button" aria-label="Thank you">
      <span class="emoji">ğŸ™</span><span class="label">Thanks</span>
    </div>
  </div>

  <!-- Message Bar -->
  <div id="message-bar">
    <div id="message-display">Tap a button to speak</div>
    <button id="speak-btn" onclick="replayLast()" aria-label="Replay">ğŸ”Š</button>
    <button id="clear-btn" onclick="clearMessage()" aria-label="Clear">âœ•</button>
  </div>

  <!-- Category Tabs -->
  <div id="tabs">
    <div class="tab active" onclick="showCategory('needs')">ğŸ½ Needs</div>
    <div class="tab" onclick="showCategory('pain')">ğŸ©¹ Pain</div>
    <div class="tab" onclick="showCategory('feelings')">ğŸ’™ Feelings</div>
    <div class="tab" onclick="showCategory('people')">ğŸ‘¤ People</div>
    <div class="tab" onclick="showCategory('actions')">âœ‹ Actions</div>
    <div class="tab" onclick="showCategory('comfort')">ğŸ›‹ Comfort</div>
  </div>

  <!-- Tile Grid -->
  <div id="grid-container">
    <div id="grid" class="grid"></div>
  </div>

</div>

<script>
// â”€â”€ Phrase Data â”€â”€
const categories = {
  needs: {
    className: 'cat-needs',
    tiles: [
      { emoji: 'ğŸ’§', label: 'Water',      phrase: 'I need water' },
      { emoji: 'ğŸ½', label: 'Hungry',      phrase: 'I am hungry' },
      { emoji: 'ğŸš½', label: 'Bathroom',    phrase: 'I need the bathroom' },
      { emoji: 'ğŸ’Š', label: 'Medicine',    phrase: 'I need my medicine' },
      { emoji: 'ğŸ‘“', label: 'Glasses',     phrase: 'I need my glasses' },
      { emoji: 'ğŸ“±', label: 'Phone',       phrase: 'I want my phone' },
      { emoji: 'ğŸ”‡', label: 'Quiet',       phrase: 'I need quiet please' },
      { emoji: 'ğŸ’¡', label: 'Light On',    phrase: 'Please turn the light on' },
      { emoji: 'ğŸŒ™', label: 'Light Off',   phrase: 'Please turn the light off' },
      { emoji: 'ğŸ§£', label: 'Cold',        phrase: 'I am cold' },
      { emoji: 'ğŸ¥µ', label: 'Hot',         phrase: 'I am hot' },
      { emoji: 'ğŸ“º', label: 'TV',          phrase: 'I want to watch TV' },
    ]
  },
  pain: {
    className: 'cat-pain',
    tiles: [
      { emoji: 'ğŸ¤•', label: 'Head',        phrase: 'My head hurts' },
      { emoji: 'ğŸ˜®â€ğŸ’¨', label: 'Chest',     phrase: 'My chest hurts' },
      { emoji: 'ğŸ«„', label: 'Stomach',     phrase: 'My stomach hurts' },
      { emoji: 'ğŸ¦µ', label: 'Legs',        phrase: 'My legs hurt' },
      { emoji: 'ğŸ¦´', label: 'Back',        phrase: 'My back hurts' },
      { emoji: 'ğŸ’ª', label: 'Arm',         phrase: 'My arm hurts' },
      { emoji: 'ğŸ˜°', label: 'A Lot',       phrase: 'The pain is very bad' },
      { emoji: 'ğŸ˜•', label: 'A Little',    phrase: 'The pain is mild' },
      { emoji: 'ğŸ“ˆ', label: 'Worse',       phrase: 'The pain is getting worse' },
      { emoji: 'ğŸ“‰', label: 'Better',      phrase: 'The pain is getting better' },
      { emoji: 'ğŸ˜´', label: 'Can\'t Sleep', phrase: 'The pain is keeping me awake' },
      { emoji: 'ğŸ¤¢', label: 'Nausea',      phrase: 'I feel nauseous' },
    ]
  },
  feelings: {
    className: 'cat-feelings',
    tiles: [
      { emoji: 'ğŸ˜Š', label: 'Happy',       phrase: 'I feel happy' },
      { emoji: 'ğŸ˜¢', label: 'Sad',         phrase: 'I feel sad' },
      { emoji: 'ğŸ˜Ÿ', label: 'Worried',     phrase: 'I feel worried' },
      { emoji: 'ğŸ˜ ', label: 'Frustrated',  phrase: 'I feel frustrated' },
      { emoji: 'ğŸ˜´', label: 'Tired',       phrase: 'I am very tired' },
      { emoji: 'ğŸ˜°', label: 'Scared',      phrase: 'I feel scared' },
      { emoji: 'ğŸ¥°', label: 'Loved',       phrase: 'I feel loved' },
      { emoji: 'ğŸ˜”', label: 'Lonely',      phrase: 'I feel lonely' },
      { emoji: 'ğŸ˜¤', label: 'Angry',       phrase: 'I feel angry' },
      { emoji: 'ğŸ˜Œ', label: 'Calm',        phrase: 'I feel calm' },
      { emoji: 'ğŸ¥±', label: 'Bored',       phrase: 'I am bored' },
      { emoji: 'ğŸ¤—', label: 'Good',        phrase: 'I feel good today' },
    ]
  },
  people: {
    className: 'cat-people',
    tiles: [
      { emoji: 'ğŸ‘©â€âš•ï¸', label: 'Nurse',    phrase: 'I need the nurse' },
      { emoji: 'ğŸ§‘â€âš•ï¸', label: 'Doctor',   phrase: 'I need the doctor' },
      { emoji: 'ğŸ‘¨â€ğŸ‘©â€ğŸ‘§', label: 'Family', phrase: 'I want to see my family' },
      { emoji: 'ğŸ‘¦', label: 'Gordon',      phrase: 'I want to see Gordon' },
      { emoji: 'ğŸ¤', label: 'Visitor',     phrase: 'Is someone coming to visit?' },
      { emoji: 'ğŸ™‹', label: 'Someone',     phrase: 'I need someone to come here' },
      { emoji: 'ğŸ‘‹', label: 'Alone',       phrase: 'I want to be alone for a while' },
      { emoji: 'ğŸ§‘â€ğŸ¤â€ğŸ§‘', label: 'Company', phrase: 'I want some company' },
      { emoji: 'ğŸ“', label: 'Call',        phrase: 'I want to call someone' },
    ]
  },
  actions: {
    className: 'cat-actions',
    tiles: [
      { emoji: 'ğŸ›', label: 'Lie Down',    phrase: 'I want to lie down' },
      { emoji: 'ğŸª‘', label: 'Sit Up',      phrase: 'Help me sit up' },
      { emoji: 'ğŸš¶', label: 'Walk',        phrase: 'I want to try walking' },
      { emoji: 'ğŸ”„', label: 'Turn Over',   phrase: 'Help me turn over' },
      { emoji: 'ğŸš¿', label: 'Wash',        phrase: 'I want to wash up' },
      { emoji: 'ğŸ‘•', label: 'Change',      phrase: 'I want to change clothes' },
      { emoji: 'ğŸª¥', label: 'Teeth',       phrase: 'I want to brush my teeth' },
      { emoji: 'ğŸ´', label: 'Eat',         phrase: 'I am ready to eat' },
      { emoji: 'ğŸ›‘', label: 'Stop',        phrase: 'Please stop' },
      { emoji: 'â³', label: 'Wait',        phrase: 'Please wait a moment' },
      { emoji: 'ğŸ”', label: 'Again',       phrase: 'Please do that again' },
      { emoji: 'â†©ï¸', label: 'Go Back',     phrase: 'I changed my mind' },
    ]
  },
  comfort: {
    className: 'cat-comfort',
    tiles: [
      { emoji: 'ğŸ›', label: 'Pillow',      phrase: 'Please adjust my pillow' },
      { emoji: 'ğŸ§Š', label: 'Ice',         phrase: 'I want some ice' },
      { emoji: 'â˜•', label: 'Warm Drink',  phrase: 'I want a warm drink' },
      { emoji: 'ğŸ«—', label: 'Straw',       phrase: 'I need a straw' },
      { emoji: 'ğŸ“»', label: 'Music',       phrase: 'I want to listen to music' },
      { emoji: 'ğŸªŸ', label: 'Window',      phrase: 'Please open the window' },
      { emoji: 'ğŸšª', label: 'Door',        phrase: 'Please close the door' },
      { emoji: 'ğŸ¤§', label: 'Tissue',      phrase: 'I need a tissue' },
      { emoji: 'ğŸ§´', label: 'Lotion',      phrase: 'I need lotion please' },
      { emoji: 'ğŸ˜®â€ğŸ’¨', label: 'Fresh Air', phrase: 'I want fresh air' },
      { emoji: 'â¤ï¸', label: 'Hug',        phrase: 'I would like a hug' },
      { emoji: 'ğŸ™‚', label: 'I\'m OK',    phrase: 'I am okay, don\'t worry' },
    ]
  }
};

let currentCategory = 'needs';
let lastPhrase = '';

// â”€â”€ Speech â”€â”€
function speak(phrase) {
  lastPhrase = phrase;

  // Update display
  document.getElementById('message-display').textContent = phrase;

  // Speak it
  if ('speechSynthesis' in window) {
    window.speechSynthesis.cancel();
    const utter = new SpeechSynthesisUtterance(phrase);
    utter.rate = 0.9;
    utter.pitch = 1.0;
    utter.volume = 1.0;
    // Prefer a clear English voice
    const voices = window.speechSynthesis.getVoices();
    const preferred = voices.find(v => v.name.includes('Samantha')) ||
                      voices.find(v => v.lang.startsWith('en') && v.localService) ||
                      voices[0];
    if (preferred) utter.voice = preferred;
    window.speechSynthesis.speak(utter);
  }

  // Flash the tile
  if (event && event.currentTarget) {
    const tile = event.currentTarget;
    tile.classList.add('spoken');
    setTimeout(() => tile.classList.remove('spoken'), 600);
  }
}

function replayLast() {
  if (lastPhrase) speak(lastPhrase);
}

function clearMessage() {
  lastPhrase = '';
  document.getElementById('message-display').textContent = 'Tap a button to speak';
  window.speechSynthesis.cancel();
}

// â”€â”€ Category Navigation â”€â”€
function showCategory(name) {
  currentCategory = name;

  // Update tabs
  document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
  event.currentTarget.classList.add('active');

  renderGrid();
}

function renderGrid() {
  const cat = categories[currentCategory];
  const grid = document.getElementById('grid');
  grid.className = 'grid ' + cat.className;

  grid.innerHTML = cat.tiles.map(t =>
    `<div class="tile" onclick="speak('${t.phrase.replace(/'/g, "\\'")}')" role="button" aria-label="${t.phrase}">
      <span class="emoji">${t.emoji}</span>
      <span class="label">${t.label}</span>
    </div>`
  ).join('');
}

// â”€â”€ Init â”€â”€
// Preload voices (Safari needs this)
if ('speechSynthesis' in window) {
  speechSynthesis.getVoices();
  speechSynthesis.onvoiceschanged = () => speechSynthesis.getVoices();
}

renderGrid();
</script>
</body>
</html>
